<?xml version="1.0" encoding="UTF-8"?>
<!--
    Copyright (C) 2022 - Today: GRAP (http://www.grap.coop)
    Copyright (C) 2022 - Today: Coop IT Easy SC
    @author: Sylvain LE GAL (https://twitter.com/legalsylvain)
    @author: Carmen Bianca Bakker
    License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
-->
<templates id="template" xml:space="preserve">

    <t t-extend="ClientLine">
        <t t-jquery=".client-line:last-child" t-operation="append">
            <td><t t-esc='partner.wallet_balance and widget.format_currency(partner.wallet_balance) or ""'/></td>
        </t>
    </t>

    <t t-extend="ClientListScreenWidget">
        <t t-jquery=".client-list thead tr:last-child" t-operation="append">
            <th>Wallet Balance</th>
        </t>
    </t>

    <t t-extend="ClientDetails">
        <t t-jquery=".client-details-right:last-child" t-operation="append">
            <div t-attf-class='client-detail #{partner.wallet_balance == 0 ? "oe_hidden" : ""}'>
                <span class='label'>Wallet Balance</span>
                <span class='detail wallet_balance'><t t-esc='widget.format_currency(partner.wallet_balance) or ""'/></span>
            </div>
        </t>
    </t>

    <t t-extend="ClientDetailsEdit">
        <t t-jquery=".client-details-right:last-child" t-operation="append">
            <div t-attf-class='client-detail #{partner.wallet_balance == 0 ? "oe_hidden" : ""}'>
                <span class='label'>Wallet Balance</span>
                <span class='detail wallet_balance'><t t-esc='widget.format_currency(partner.wallet_balance) or ""'/></span>
            </div>
        </t>
    </t>

    <t t-extend="PaymentScreenWidget">
        <t t-jquery=".payment-buttons" t-operation="after">
            <div class="balance-container">
                <t t-if="widget.pos.config.is_enabled_wallet">
                    <h3 class="balance-header">
                        <t>
                            Wallet Balance
                        </t>
                    </h3>
                    <div class="balance">
                        <t t-if="widget.pos.get_order().get_client()">
                            <t
                                t-esc="widget.format_currency(widget.pos.get_order().get_client().wallet_balance)"
                            />
                        </t>
                    </div>
                </t>
            </div>
        </t>
    </t>

    <t t-extend="PosTicket">
        <!--
            Customer must see his balance even if it does not use
            customer wallet as a payment method for this order.
            Because it's the only way he can check his balance.
        -->
        <t t-jquery=".receipt-change" t-operation="after">
            <t t-if="widget.pos.get_order().get_client() and widget.pos.is_enabled_wallet">
                <table class="receipt-customer-wallet-balance">
                    <tr>
                        <td>Wallet Balance:</td>
                        <td class="pos-right-align">
                            <t
                                t-esc="widget.format_currency(order.pos.get_client().wallet_balance)"
                            />
                        </td>
                    </tr>
                </table>
            </t>
        </t>
    </t>

    <t t-extend="XmlReceipt">
        <t t-jquery=".before-footer" t-operation="before">
            <line class="total_foodprint_amount">
                <left>Wallet Balance:</left>
                <right><t
                        t-esc="widget.format_currency(receipt.wallet_balance)"
                    /></right>
            </line>
        </t>
    </t>

</templates>
